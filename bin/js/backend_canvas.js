(function(){function F(a,d){if(null==d)return null;null==d.__id__&&(d.__id__=G++);var b;null==a.hx__closures__?a.hx__closures__={}:b=a.hx__closures__[d.__id__];null==b&&(b=function(){return b.method.apply(b.scope,arguments)},b.scope=a,b.method=d,a.hx__closures__[d.__id__]=b);return b}var v=function(a,d){this.r=new RegExp(a,d.split("u").join(""))};v.prototype={match:function(a){this.r.global&&(this.r.lastIndex=0);this.r.m=this.r.exec(a);this.r.s=a;return null!=this.r.m}};var w=function(){};w.substr=
function(a,d,b){if(null==b)b=a.length;else if(0>b)if(0==d)b=a.length+b;else return"";return a.substr(d,b)};var x=function(){};x.exists=function(a,d){for(var b=a.iterator();b.hasNext();){var c=b.next();if(d(c))return!0}return!1};var u=function(){this.length=0};u.prototype={iterator:function(){return new y(this.h)}};var y=function(a){this.head=a};y.prototype={hasNext:function(){return null!=this.head},next:function(){var a=this.head.item;this.head=this.head.next;return a}};var A=function(a,d){this.shapes=
[];this.shapes=a;this.renderer=new z(d)},B=function(){},r=function(){this.widgets=[];for(var a=window.document.documentElement.getElementsByClassName("geometrize_widget"),d=0;d<a.length;){var b=a[d];++d;var c=b.attributes.getNamedItem("data-source");if(null!=c&&(c=c.value,0!=c.length)){var b=[b.id],e=[this];":"==c.charAt(0)?(c=w.substr(c,1,null),Object.prototype.hasOwnProperty.call(B,c)&&(c=C.field(B,c),c=q.shapesFromJson(c),this.widgets.push(new A(c,b[0])))):(c=new D(c),c.onData=function(a,b){return function(d){d=
q.shapesFromJson(d);a[0].widgets.push(new A(d,b[0]))}}(e,b),c.onError=function(){return function(a){console.log(a)}}(),c.request())}}window.onload=F(this,this.onWindowLoaded)};r.main=function(){new r};r.prototype={onWindowLoaded:function(){this.animate()},animate:function(){for(var a=this,d=0,b=this.widgets;d<b.length;){var c=b[d];++d;c.renderer.render(c.shapes)}window.setTimeout(function(){a.animate()},33)}};var C=function(){};C.field=function(a,d){try{return a[d]}catch(b){return null}};var D=function(a){this.url=
a;this.headers=new u;this.params=new u;this.async=!0;this.withCredentials=!1};D.prototype={request:function(a){var d=this;d.responseData=null;var b=this.req=E.createXMLHttpRequest(),c=function(a){if(4==b.readyState){var c;try{c=b.status}catch(e){c=null}null!=c&&"undefined"!==typeof window&&(a=window.location.protocol.toLowerCase(),(new v("^(?:about|app|app-storage|.+-extension|file|res|widget):$","")).match(a)&&(c=null!=b.responseText?200:404));void 0==c&&(c=null);if(null!=c)d.onStatus(c);if(null!=
c&&200<=c&&400>c)d.req=null,d.onData(d.responseData=b.responseText);else if(null==c)d.req=null,d.onError("Failed to connect or resolve host");else switch(c){case 12007:d.req=null;d.onError("Unknown host");break;case 12029:d.req=null;d.onError("Failed to connect to host");break;default:d.req=null,d.responseData=b.responseText,d.onError("Http Error #"+b.status)}}};this.async&&(b.onreadystatechange=c);var e=this.postData;if(null!=e)a=!0;else for(var f=this.params.h;null!=f;)var g=f.item,f=f.next,e=null==
e?"":e+"&",h=encodeURIComponent(g.param)+"=",e=e+(h+encodeURIComponent(g.value));try{if(a)b.open("POST",this.url,this.async);else if(null!=e){var k=1>=this.url.split("?").length;b.open("GET",this.url+(k?"?":"&")+e,this.async);e=null}else b.open("GET",this.url,this.async)}catch(t){t instanceof l&&(t=t.val);d.req=null;this.onError(t.toString());return}b.withCredentials=this.withCredentials;!x.exists(this.headers,function(a){return"Content-Type"==a.header})&&a&&null==this.postData&&b.setRequestHeader("Content-Type",
"application/x-www-form-urlencoded");for(a=this.headers.h;null!=a;)f=a.item,a=a.next,b.setRequestHeader(f.header,f.value);b.send(e);this.async||c(null)},onData:function(a){},onError:function(a){},onStatus:function(a){}};var l=function(a){Error.call(this);this.val=a;this.message=String(a);Error.captureStackTrace&&Error.captureStackTrace(this,l)};l.wrap=function(a){return a instanceof Error?a:new l(a)};l.__super__=Error;l.prototype=function(a,d){function b(){}b.prototype=a;var c=new b,e;for(e in d)c[e]=
d[e];d.toString!==Object.prototype.toString&&(c.toString=d.toString);return c}(Error.prototype,{});var E=function(){};E.createXMLHttpRequest=function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)return new ActiveXObject("Microsoft.XMLHTTP");throw new l("Unable to create XMLHttpRequest object.");};var q=function(){};q.shapeDataFromJson=function(a){return JSON.parse(a).shapes};q.shapesFromJson=function(a){a=JSON.parse(a).shapes;for(var d=[],
b=0;b<a.length;){var c=a[b];++b;var e=c.color;d.push({type:c.type,color:(((e[0]|0)&255)<<24)+(((e[1]|0)&255)<<16)+(((e[2]|0)&255)<<8)+((e[3]|0)&255),data:c.data})}return d};var z=function(a){a=window.document.getElementById(a);this.canvas=window.document.createElement("canvas");this.ctx=this.canvas.getContext("2d",null);this.canvas.width=800;this.canvas.height=600;a.appendChild(this.canvas)};z.prototype={render:function(a){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);for(var d=0;d<
a.length;){var b=a[d];++d;switch(b.type){case 1:var c=b.data,b=b.color;this.ctx.fillStyle="rgba("+(b>>24&255)+","+(b>>16&255)+","+(b>>8&255)+","+(b&255)/255+")";this.ctx.fillRect(g.get_x1(c),g.get_y1(c),g.get_x2(c)-g.get_x1(c),g.get_y2(c)-g.get_y1(c));break;case 2:c=b.data;b=b.color;this.ctx.fillStyle="rgba("+(b>>24&255)+","+(b>>16&255)+","+(b>>8&255)+","+(b&255)/255+")";this.ctx.save();this.ctx.translate(e.get_x1(c)+(e.get_x2(c)-e.get_x1(c))/2,e.get_y1(c)+(e.get_y2(c)-e.get_y1(c))/2);this.ctx.rotate(e.get_angle(c)*
(Math.PI/180));this.ctx.fillRect(-(e.get_x2(c)-e.get_x1(c))/2,-(e.get_y2(c)-e.get_y1(c))/2,e.get_x2(c)-e.get_x1(c),e.get_y2(c)-e.get_y1(c));this.ctx.restore();break;case 4:c=b.data;b=b.color;this.ctx.fillStyle="rgba("+(b>>24&255)+","+(b>>16&255)+","+(b>>8&255)+","+(b&255)/255+")";this.ctx.beginPath();this.ctx.moveTo(f.get_x1(c),f.get_y1(c));this.ctx.lineTo(f.get_x2(c),f.get_y2(c));this.ctx.lineTo(f.get_x3(c),f.get_y3(c));this.ctx.lineTo(f.get_x1(c),f.get_y1(c));this.ctx.fill();break;case 8:c=b.data;
b=b.color;this.ctx.fillStyle="rgba("+(b>>24&255)+","+(b>>16&255)+","+(b>>8&255)+","+(b&255)/255+")";this.ctx.beginPath();this.ctx.ellipse(m.get_x(c),m.get_y(c),m.get_rx(c),m.get_ry(c),0,0,360);this.ctx.fill();break;case 16:c=b.data;b=b.color;this.ctx.fillStyle="rgba("+(b>>24&255)+","+(b>>16&255)+","+(b>>8&255)+","+(b&255)/255+")";this.ctx.beginPath();this.ctx.ellipse(k.get_x(c),k.get_y(c),k.get_rx(c),k.get_ry(c),k.get_angle(c)*(Math.PI/180),0,360);this.ctx.fill();break;case 32:c=b.data;b=b.color;
this.ctx.fillStyle="rgba("+(b>>24&255)+","+(b>>16&255)+","+(b>>8&255)+","+(b&255)/255+")";this.ctx.beginPath();this.ctx.arc(p.get_x(c),p.get_y(c),p.get_r(c),0,2*Math.PI);this.ctx.fill();break;case 64:c=b.data;b=b.color;this.ctx.strokeStyle="rgba("+(b>>24&255)+","+(b>>16&255)+","+(b>>8&255)+","+(b&255)/255+")";this.ctx.beginPath();this.ctx.moveTo(n.get_x1(c),n.get_y1(c));this.ctx.lineTo(n.get_x2(c),n.get_y2(c));this.ctx.stroke();break;case 128:c=b.data;b=b.color;this.ctx.strokeStyle="rgba("+(b>>24&
255)+","+(b>>16&255)+","+(b>>8&255)+","+(b&255)/255+")";this.ctx.beginPath();this.ctx.moveTo(h.get_x1(c),h.get_y1(c));this.ctx.quadraticCurveTo(h.get_cx(c),h.get_cy(c),h.get_x2(c),h.get_y2(c));this.ctx.stroke();break;case 256:c=b.data;b=b.color;this.ctx.strokeStyle="rgba("+(b>>24&255)+","+(b>>16&255)+","+(b>>8&255)+","+(b&255)/255+")";this.ctx.beginPath();for(b=0;b<c.length-1;)this.ctx.lineTo(c[b],c[b+1]),b+=2;this.ctx.stroke();break;default:throw new l("Encountered unsupported shape type");}}},drawRectangle:function(a,
d){this.ctx.fillStyle="rgba("+(d>>24&255)+","+(d>>16&255)+","+(d>>8&255)+","+(d&255)/255+")";this.ctx.fillRect(g.get_x1(a),g.get_y1(a),g.get_x2(a)-g.get_x1(a),g.get_y2(a)-g.get_y1(a))},drawRotatedRectangle:function(a,d){this.ctx.fillStyle="rgba("+(d>>24&255)+","+(d>>16&255)+","+(d>>8&255)+","+(d&255)/255+")";this.ctx.save();this.ctx.translate(e.get_x1(a)+(e.get_x2(a)-e.get_x1(a))/2,e.get_y1(a)+(e.get_y2(a)-e.get_y1(a))/2);this.ctx.rotate(e.get_angle(a)*(Math.PI/180));this.ctx.fillRect(-(e.get_x2(a)-
e.get_x1(a))/2,-(e.get_y2(a)-e.get_y1(a))/2,e.get_x2(a)-e.get_x1(a),e.get_y2(a)-e.get_y1(a));this.ctx.restore()},drawTriangle:function(a,d){this.ctx.fillStyle="rgba("+(d>>24&255)+","+(d>>16&255)+","+(d>>8&255)+","+(d&255)/255+")";this.ctx.beginPath();this.ctx.moveTo(f.get_x1(a),f.get_y1(a));this.ctx.lineTo(f.get_x2(a),f.get_y2(a));this.ctx.lineTo(f.get_x3(a),f.get_y3(a));this.ctx.lineTo(f.get_x1(a),f.get_y1(a));this.ctx.fill()},drawEllipse:function(a,d){this.ctx.fillStyle="rgba("+(d>>24&255)+","+
(d>>16&255)+","+(d>>8&255)+","+(d&255)/255+")";this.ctx.beginPath();this.ctx.ellipse(m.get_x(a),m.get_y(a),m.get_rx(a),m.get_ry(a),0,0,360);this.ctx.fill()},drawRotatedEllipse:function(a,d){this.ctx.fillStyle="rgba("+(d>>24&255)+","+(d>>16&255)+","+(d>>8&255)+","+(d&255)/255+")";this.ctx.beginPath();this.ctx.ellipse(k.get_x(a),k.get_y(a),k.get_rx(a),k.get_ry(a),k.get_angle(a)*(Math.PI/180),0,360);this.ctx.fill()},drawCircle:function(a,d){this.ctx.fillStyle="rgba("+(d>>24&255)+","+(d>>16&255)+","+
(d>>8&255)+","+(d&255)/255+")";this.ctx.beginPath();this.ctx.arc(p.get_x(a),p.get_y(a),p.get_r(a),0,2*Math.PI);this.ctx.fill()},drawLine:function(a,d){this.ctx.strokeStyle="rgba("+(d>>24&255)+","+(d>>16&255)+","+(d>>8&255)+","+(d&255)/255+")";this.ctx.beginPath();this.ctx.moveTo(n.get_x1(a),n.get_y1(a));this.ctx.lineTo(n.get_x2(a),n.get_y2(a));this.ctx.stroke()},drawQuadraticBezier:function(a,d){this.ctx.strokeStyle="rgba("+(d>>24&255)+","+(d>>16&255)+","+(d>>8&255)+","+(d&255)/255+")";this.ctx.beginPath();
this.ctx.moveTo(h.get_x1(a),h.get_y1(a));this.ctx.quadraticCurveTo(h.get_cx(a),h.get_cy(a),h.get_x2(a),h.get_y2(a));this.ctx.stroke()},drawPolyline:function(a,d){this.ctx.strokeStyle="rgba("+(d>>24&255)+","+(d>>16&255)+","+(d>>8&255)+","+(d&255)/255+")";this.ctx.beginPath();for(var b=0;b<a.length-1;)this.ctx.lineTo(a[b],a[b+1]),b+=2;this.ctx.stroke()}};var p={get_x:function(a){return a[0]},get_y:function(a){return a[1]},get_r:function(a){return a[2]}},m={get_x:function(a){return a[0]},get_y:function(a){return a[1]},
get_rx:function(a){return a[2]},get_ry:function(a){return a[3]}},n={get_x1:function(a){return a[0]},get_y1:function(a){return a[1]},get_x2:function(a){return a[2]},get_y2:function(a){return a[3]}},h={get_x1:function(a){return a[0]},get_y1:function(a){return a[1]},get_cx:function(a){return a[2]},get_cy:function(a){return a[3]},get_x2:function(a){return a[4]},get_y2:function(a){return a[5]}},g={get_x1:function(a){return a[0]},get_y1:function(a){return a[1]},get_x2:function(a){return a[2]},get_y2:function(a){return a[3]}},
k={get_x:function(a){return a[0]},get_y:function(a){return a[1]},get_rx:function(a){return a[2]},get_ry:function(a){return a[3]},get_angle:function(a){return a[4]}},e={get_x1:function(a){return a[0]},get_y1:function(a){return a[1]},get_x2:function(a){return a[2]},get_y2:function(a){return a[3]},get_angle:function(a){return a[4]}},f={get_x1:function(a){return a[0]},get_y1:function(a){return a[1]},get_x2:function(a){return a[2]},get_y2:function(a){return a[3]},get_x3:function(a){return a[4]},get_y3:function(a){return a[5]}},
G=0;r.main()})();
